---
// src/components/Header.astro
const { pathname } = Astro.url;
const isHomePage = pathname === '/';
const navLinks = [
  { href: '#inicio', label: 'Inicio' },
  { href: '#servicios', label: 'Servicios' },
  { href: '#torneos', label: 'Torneos' },
  { href: '#nosotros', label: 'Nosotros' },
  { href: '#contacto', label: 'Contacto' },
];
const socialLinks = [
    { href: "https://www.facebook.com/p/Profutbol-JC-100083072811985/", icon: "fab fa-facebook-f", label: "Facebook"},
    { href: "https://www.instagram.com/profutboljc/", icon: "fab fa-instagram", label: "Instagram"},
    { href: "https://www.tiktok.com/@profutbol.jc", icon: "fab fa-tiktok", label: "TikTok"}
];

const getLink = (href: string) => {
    if (isHomePage) {
        return href;
    }
    if (href === '#inicio') return '/';
    return `/${href}`;
}
---

<header 
  id="header" 
  class="fixed top-0 left-0 right-0 z-50 transition-all duration-300 bg-white/80 backdrop-blur-lg shadow-sm" 
  role="banner">
  <nav 
    class="container mx-auto px-4 lg:px-6" 
    role="navigation" 
    aria-label="Navegación principal">
    
    <div class="flex items-center justify-between h-20 lg:h-24">
      {/* Columna Izquierda: Redes Sociales */}
      <div class="hidden lg:flex items-center gap-4 flex-1">
        {socialLinks.map(link => (
          <a href={link.href} target="_blank" rel="noopener noreferrer" aria-label={`Síguenos en ${link.label}`} class="text-gray-600 hover:text-yellow-500 transition-colors">
             <i class={link.icon} aria-hidden="true"></i>
          </a>
        ))}
      </div>

      {/* Columna Central: Logo */}
      <div class="flex-shrink-0">
        <a 
          href="/" 
          class="inline-flex items-center gap-3 group focus:outline-none focus-visible:ring-2 focus-visible:ring-yellow-500 focus-visible:ring-offset-2 rounded-lg px-2 py-1 transition-transform hover:scale-105"
          aria-label="Profutbol JC - Página de inicio">
          <img 
            src="/images/profutbol.png" 
            alt="Logo de Profutbol JC" 
            width="45" 
            height="45" 
            class="h-10 w-10 lg:h-12 lg:w-12 transition-transform group-hover:rotate-6"
            loading="eager">
          
          <span class="text-lg lg:text-xl font-bold text-gray-900 tracking-tight group-hover:text-yellow-500 transition-colors">
            PROFUTBOL JC
          </span>
        </a>
      </div>
      
      {/* Menú móvil */}
       <div class="flex-1 flex justify-end lg:hidden">
            <button 
                type="button"
                id="mobile-menu-button"
                class="flex items-center justify-center w-10 h-10 rounded-lg border-2 border-yellow-500 text-gray-900 hover:bg-yellow-50 transition-colors focus:outline-none focus-visible:ring-2 focus-visible:ring-yellow-500 focus-visible:ring-offset-2"
                aria-controls="mobile-menu"
                aria-expanded="false"
                aria-label="Abrir menú de navegación">
                <svg 
                class="hamburger w-6 h-6 transition-transform duration-300" 
                fill="none" 
                stroke="currentColor" 
                viewBox="0 0 24 24"
                aria-hidden="true">
                <path class="line-1" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16" />
                <path class="line-2" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 12h16" />
                <path class="line-3" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 18h16" />
                </svg>
            </button>
       </div>

      {/* Columna Derecha: Navegación y Botón */}
      <div class="hidden lg:flex items-center justify-end gap-2 flex-1">
        <ul class="flex items-center gap-1" role="menubar">
          {navLinks.map((link) => (
           <li role="none">
              <a 
                href={getLink(link.href)}
                role="menuitem"
                data-nav-link={link.href}
                class:list={[
                    "nav-link px-4 py-2 text-sm font-semibold text-gray-700 hover:text-yellow-500 rounded-lg transition-all duration-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-yellow-500 focus-visible:ring-offset-2",
                    // Añadimos una clase base para identificar los enlaces
                ]}>
                 {link.label}
              </a>
            </li>
          ))}
        </ul>

        <a 
          href="https://wa.me/573203459145" 
          target="_blank" 
          rel="noopener noreferrer"
          class="ml-4 px-5 py-2 text-sm font-bold border-2 border-gray-900 text-gray-900 rounded-md hover:bg-yellow-500 hover:text-white hover:border-yellow-500 transition-all duration-300 transform hover:scale-105 focus:outline-none focus-visible:ring-2 focus-visible:ring-yellow-500 focus-visible:ring-offset-2"
          aria-label="Reservar una cancha por WhatsApp - Abre en nueva ventana">
          Reservar
        </a>
      </div>
    </div>
    
    <div 
      id="mobile-menu"
      class="lg:hidden overflow-hidden transition-all duration-300 ease-in-out max-h-0"
      aria-labelledby="mobile-menu-title">
      <div class="py-4 border-t border-gray-100">
         <h2 id="mobile-menu-title" class="sr-only">Menú de navegación</h2>
        <ul class="flex flex-col gap-2" role="menubar">
          {navLinks.map((link) => (
            <li role="none">
              <a 
                href={getLink(link.href)}
                role="menuitem"
                data-nav-link={link.href}
                class="mobile-nav-link flex items-center justify-center px-4 py-3 text-base font-semibold text-gray-700 hover:text-yellow-500 hover:bg-yellow-50 rounded-lg transition-all duration-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-yellow-500 focus-visible:ring-inset transform hover:scale-[1.02]">
                {link.label}
              </a>
            </li>
          ))}
        </ul>
         <div class="mt-4 pt-4 border-t border-gray-100">
          <a 
            href="https://wa.me/573203459145" 
            target="_blank" 
            rel="noopener noreferrer"
            class="flex items-center justify-center gap-3 w-full px-6 py-4 bg-gradient-to-r from-yellow-400 to-yellow-500 hover:from-yellow-500 hover:to-yellow-600 text-gray-900 font-bold rounded-lg shadow-md hover:shadow-lg transform hover:scale-[1.02] transition-all duration-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-yellow-500 focus-visible:ring-offset-2"
            aria-label="Contactar por WhatsApp - Abre en nueva ventana">
            <i class="fab fa-whatsapp text-2xl" aria-hidden="true"></i>
            <span>Contáctanos por WhatsApp</span>
          </a>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="h-20 lg:h-24" aria-hidden="true"></div>

{/* --- INICIO DE LA SECCIÓN MODIFICADA --- */}
<style>
  .nav-link.active,
  .mobile-nav-link.active {
    @apply text-yellow-500 font-bold;
  }
</style>

<script>
  // Mobile menu toggle
  const mobileMenuButton = document.getElementById('mobile-menu-button');
  const mobileMenu = document.getElementById('mobile-menu');
  
  if (mobileMenuButton && mobileMenu) {
    mobileMenuButton.addEventListener('click', () => {
      const isExpanded = mobileMenuButton.getAttribute('aria-expanded') === 'true';
      mobileMenuButton.setAttribute('aria-expanded', String(!isExpanded));
      mobileMenu.style.maxHeight = isExpanded ? '0px' : mobileMenu.scrollHeight + 'px';
    });
  }

  // Active link on scroll
  document.addEventListener('DOMContentLoaded', () => {
    const sections = document.querySelectorAll('section[id]');
    const navLinks = document.querySelectorAll('a[data-nav-link]');
    
    if (sections.length === 0 || navLinks.length === 0) return;

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          const id = entry.target.getAttribute('id');
          navLinks.forEach(link => {
            link.classList.remove('active');
            if (link.getAttribute('data-nav-link') === `#${id}`) {
              link.classList.add('active');
            }
          });
        }
      });
    }, {
      rootMargin: '-50% 0px -50% 0px', // Activa el enlace cuando la sección está en el centro de la pantalla
      threshold: 0
    });

    sections.forEach(section => {
      observer.observe(section);
    });

    // Manejo especial para el enlace "Inicio"
    const heroSection = document.querySelector('section'); // La primera sección es el hero
    const inicioLinks = document.querySelectorAll('a[data-nav-link="#inicio"]');
    
    const heroObserver = new IntersectionObserver((entries) => {
        if (entries[0].isIntersecting) {
            navLinks.forEach(link => link.classList.remove('active'));
            inicioLinks.forEach(link => link.classList.add('active'));
        }
    }, {
        threshold: 0.5
    });

    if (heroSection) {
        heroObserver.observe(heroSection);
    }
  });
</script>
{/* --- FIN DE LA SECCIÓN MODIFICADA --- */}