---
// Header.astro
const navLinks = [
  { href: '#inicio', label: 'Inicio' },
  { href: '#servicios', label: 'Servicios' },
  { href: '#nosotros', label: 'Nosotros' },
  { href: '#torneos', label: 'Torneos' }, // <-- ENLACE AÑADIDO
  { href: '#contacto', label: 'Contacto' },
];

const socialLinks = [
    { href: "https://www.facebook.com/p/Profutbol-JC-100083072811985/", icon: "fab fa-facebook-f", label: "Facebook"},
    { href: "https://www.instagram.com/profutboljc/", icon: "fab fa-instagram", label: "Instagram"},
    { href: "https://www.tiktok.com/@profutbol.jc", icon: "fab fa-tiktok", label: "TikTok"}
];
---

<header 
  id="header" 
  class="fixed top-0 left-0 right-0 z-50 transition-all duration-300 bg-white/80 backdrop-blur-lg" 
  role="banner">
  <nav 
    class="container mx-auto px-4 lg:px-6" 
    role="navigation" 
    aria-label="Navegación principal">
    
    <div class="relative flex items-center justify-between h-20 lg:h-24">

      <div class="hidden lg:flex items-center gap-4">
        {socialLinks.map(link => (
          <a href={link.href} target="_blank" rel="noopener noreferrer" aria-label={`Siguenos en ${link.label}`} class="text-gray-600 hover:text-yellow-500 transition-colors">
            <i class={link.icon} aria-hidden="true"></i>
          </a>
        ))}
      </div>

      <div class="flex-1 lg:absolute lg:left-1/2 lg:-translate-x-1/2 lg:flex-none">
        <a 
          href="#inicio" 
          class="inline-flex items-center gap-3 group focus:outline-none focus-visible:ring-2 focus-visible:ring-yellow-500 focus-visible:ring-offset-2 rounded-lg px-2 py-1 transition-transform hover:scale-105"
          aria-label="Profutbol JC - Página de inicio">
          <img 
            src="/images/profutbol.png" 
            alt="Logo de Profutbol JC" 
            width="45" 
            height="45" 
            class="h-10 w-10 lg:h-12 lg:w-12 transition-transform group-hover:rotate-6"
            loading="eager">
          
          <span class="text-lg lg:text-xl font-bold text-gray-900 tracking-tight group-hover:text-yellow-500 transition-colors">
            PROFUTBOL JC
          </span>
        </a>
      </div>

      <div class="hidden lg:flex items-center gap-2">
        <ul class="flex items-center gap-1" role="menubar">
          {navLinks.map((link) => (
            <li role="none">
              <a 
                href={link.href}
                role="menuitem"
                class="nav-link px-4 py-2 text-sm font-semibold text-gray-700 hover:text-yellow-500 rounded-lg transition-colors duration-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-yellow-500 focus-visible:ring-offset-2">
                {link.label}
              </a>
            </li>
          ))}
        </ul>

        <a 
          href="https://wa.me/573203459145" 
          target="_blank" 
          rel="noopener noreferrer"
          class="ml-4 px-5 py-2 text-sm font-bold border-2 border-gray-900 text-gray-900 rounded-md hover:bg-yellow-500 hover:text-white hover:border-yellow-500 transition-all duration-300 transform hover:scale-105 focus:outline-none focus-visible:ring-2 focus-visible:ring-yellow-500 focus-visible:ring-offset-2"
          aria-label="Reservar una cancha por WhatsApp - Abre en nueva ventana">
          Reservar
        </a>
      </div>

      <button 
        type="button"
        id="mobile-menu-button"
        class="lg:hidden flex items-center justify-center w-10 h-10 rounded-lg border-2 border-yellow-500 text-gray-900 hover:bg-yellow-50 transition-colors focus:outline-none focus-visible:ring-2 focus-visible:ring-yellow-500 focus-visible:ring-offset-2"
        aria-controls="mobile-menu"
        aria-expanded="false"
        aria-label="Abrir menú de navegación">
        <svg 
          class="hamburger w-6 h-6 transition-transform duration-300" 
          fill="none" 
          stroke="currentColor" 
          viewBox="0 0 24 24"
          aria-hidden="true">
          <path 
            class="line-1" 
            stroke-linecap="round" 
            stroke-linejoin="round" 
            stroke-width="2" 
            d="M4 6h16" />
          <path 
            class="line-2" 
            stroke-linecap="round" 
            stroke-linejoin="round" 
            stroke-width="2" 
            d="M4 12h16" />
          <path 
            class="line-3" 
            stroke-linecap="round" 
            stroke-linejoin="round" 
            stroke-width="2" 
            d="M4 18h16" />
        </svg>
      </button>
    </div>

    <div 
      id="mobile-menu"
      class="lg:hidden overflow-hidden transition-all duration-300 ease-in-out max-h-0 opacity-0"
      role="dialog"
      aria-modal="true"
      aria-labelledby="mobile-menu-title">
      
      <div class="py-4 border-t border-gray-100">
        <h2 id="mobile-menu-title" class="sr-only">Menú de navegación</h2>
        
        <ul class="flex flex-col gap-2" role="menubar">
          {navLinks.map((link) => (
            <li role="none">
              <a 
                href={link.href}
                role="menuitem"
                class="mobile-nav-link flex items-center justify-center px-4 py-3 text-base font-semibold text-gray-700 hover:text-yellow-500 hover:bg-yellow-50 rounded-lg transition-all duration-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-yellow-500 focus-visible:ring-inset transform hover:scale-[1.02]">
                {link.label}
              </a>
            </li>
          ))}
        </ul>

        <div class="mt-4 pt-4 border-t border-gray-100">
          <a 
            href="https://wa.me/573203459145" 
            target="_blank" 
            rel="noopener noreferrer"
            class="flex items-center justify-center gap-3 w-full px-6 py-4 bg-gradient-to-r from-yellow-400 to-yellow-500 hover:from-yellow-500 hover:to-yellow-600 text-gray-900 font-bold rounded-lg shadow-md hover:shadow-lg transform hover:scale-[1.02] transition-all duration-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-yellow-500 focus-visible:ring-offset-2"
            aria-label="Contactar por WhatsApp - Abre en nueva ventana">
            <i class="fab fa-whatsapp text-2xl" aria-hidden="true"></i>
            <span>Contáctanos por WhatsApp</span>
          </a>
        </div>
      </div>
    </div>
  </nav>
</header>

<div class="h-20 lg:h-24" aria-hidden="true"></div>

<style>
  #header.scrolled {
     @apply shadow-md;
    background-color: rgba(255, 255, 255, 0.95);
  }

  /* Animación del menú hamburguesa */
  #mobile-menu-button[aria-expanded="true"] .hamburger {
    @apply rotate-90;
  }
  #mobile-menu-button[aria-expanded="true"] .line-1 {
    transform: rotate(45deg) translate(5px, 5px);
  }
  #mobile-menu-button[aria-expanded="true"] .line-2 {
    opacity: 0;
  }
  #mobile-menu-button[aria-expanded="true"] .line-3 {
    transform: rotate(-45deg) translate(7px, -6px);
  }

  /* Animación stagger para los items del menú móvil */
  .mobile-nav-link {
    animation: slideInFromRight 0.3s ease-out backwards;
  }

  .mobile-nav-link:nth-child(1) { animation-delay: 0.05s; }
  .mobile-nav-link:nth-child(2) { animation-delay: 0.1s; }
  .mobile-nav-link:nth-child(3) { animation-delay: 0.15s; }
  .mobile-nav-link:nth-child(4) { animation-delay: 0.2s; }

  @keyframes slideInFromRight {
    from {
      opacity: 0;
      transform: translateX(20px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border-width: 0;
  }

  @media (prefers-reduced-motion: reduce) {
    * {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
  }

  @supports (backdrop-filter: blur(10px)) {
    #header {
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }
  }
</style>

<script>
  // Mobile menu toggle
  const mobileMenuButton = document.getElementById('mobile-menu-button');
  const mobileMenu = document.getElementById('mobile-menu');
  const header = document.getElementById('header');

  if (mobileMenuButton && mobileMenu) {
    mobileMenuButton.addEventListener('click', () => {
      const isExpanded = mobileMenuButton.getAttribute('aria-expanded') === 'true';
      
      mobileMenuButton.setAttribute('aria-expanded', (!isExpanded).toString());
      
      if (isExpanded) {
        mobileMenu.style.maxHeight = '0px';
        mobileMenu.style.opacity = '0';
      } else {
        mobileMenu.style.maxHeight = mobileMenu.scrollHeight + 'px';
        mobileMenu.style.opacity = '1';
      }
    });
    
    const mobileNavLinks = mobileMenu.querySelectorAll('a[href^="#"]');
    mobileNavLinks.forEach(link => {
      link.addEventListener('click', () => {
        mobileMenuButton.setAttribute('aria-expanded', 'false');
        mobileMenu.style.maxHeight = '0px';
        mobileMenu.style.opacity = '0';
      });
    });

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && mobileMenuButton.getAttribute('aria-expanded') === 'true') {
        mobileMenuButton.setAttribute('aria-expanded', 'false');
        mobileMenu.style.maxHeight = '0px';
        mobileMenu.style.opacity = '0';
        mobileMenuButton.focus();
      }
    });

    document.addEventListener('click', (e) => {
      if (mobileMenuButton.getAttribute('aria-expanded') === 'true') {
        if (!header?.contains(e.target as Node)) {
          mobileMenuButton.setAttribute('aria-expanded', 'false');
          mobileMenu.style.maxHeight = '0px';
          mobileMenu.style.opacity = '0';
        }
      }
    });
  }

  // Header scroll effect
  window.addEventListener('scroll', () => {
    const headerElement = document.getElementById('header');
    if (headerElement) {
      if (window.scrollY > 50) {
        headerElement.classList.add('scrolled');
        headerElement.classList.add('shadow-sm');
      } else {
        headerElement.classList.remove('scrolled');
        headerElement.classList.remove('shadow-sm');
      }
    }
  }, { passive: true });

  // Smooth scroll
  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', (e) => {
        e.preventDefault();
        const href = anchor.getAttribute('href');
        const target = document.querySelector(href || '');
        
        if (target) {
            const headerOffset = 80; // Altura del header
            const elementPosition = target.getBoundingClientRect().top;
            const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
            
            window.scrollTo({
                top: offsetPosition,
                behavior: 'smooth'
            });
        }
    });
  });
</script>